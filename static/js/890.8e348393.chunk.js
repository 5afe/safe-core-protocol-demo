/*! For license information please see 890.8e348393.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunksafe_core_protocol_app=self.webpackChunksafe_core_protocol_app||[]).push([[890],{5890:function(t,r,n){n.r(r),n.d(r,{encodeToCurve:function(){return pr},hashToCurve:function(){return yr},schnorr:function(){return hr},secp256k1:function(){return Wt}});var e={};n.r(e),n.d(e,{bitGet:function(){return W},bitLen:function(){return G},bitMask:function(){return J},bitSet:function(){return X},bytesToHex:function(){return N},bytesToNumberBE:function(){return D},bytesToNumberLE:function(){return _},concatBytes:function(){return j},createHmacDrbg:function(){return tt},ensureBytes:function(){return K},equalBytes:function(){return M},hexToBytes:function(){return P},hexToNumber:function(){return C},numberToBytesBE:function(){return V},numberToBytesLE:function(){return F},numberToHexUnpadded:function(){return H},numberToVarBytesBE:function(){return z},utf8ToBytes:function(){return Y},validateObject:function(){return nt}});var i=n(15671),o=n(43144),a=n(60136),u=n(29388),f=n(93433);function s(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("Wrong positive integer: ".concat(t))}function c(t){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");for(var r=arguments.length,n=new Array(r>1?r-1:0),e=1;e<r;e++)n[e-1]=arguments[e];if(n.length>0&&!n.includes(t.length))throw new TypeError("Expected Uint8Array of length ".concat(n,", not of length=").concat(t.length))}var h={number:s,bool:function(t){if("boolean"!==typeof t)throw new Error("Expected boolean, not ".concat(t))},bytes:c,hash:function(t){if("function"!==typeof t||"function"!==typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");s(t.outputLen),s(t.blockLen)},exists:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.destroyed)throw new Error("Hash instance has been destroyed");if(r&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,r){c(t);var n=r.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}},d=h,l="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,v=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},y=function(t,r){return t<<32-r|t>>>r};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(function(t,r){return r.toString(16).padStart(2,"0")}));function p(t){if("string"===typeof t&&(t=function(t){if("string"!==typeof t)throw new TypeError("utf8ToBytes expected string, got ".concat(typeof t));return(new TextEncoder).encode(t)}(t)),!(t instanceof Uint8Array))throw new TypeError("Expected input type is Uint8Array (got ".concat(typeof t,")"));return t}function g(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every((function(t){return t instanceof Uint8Array})))throw new Error("Uint8Array list expected");if(1===r.length)return r[0];for(var e=r.reduce((function(t,r){return t+r.length}),0),i=new Uint8Array(e),o=0,a=0;o<r.length;o++){var u=r[o];i.set(u,a),a+=u.length}return i}var w=function(){function t(){(0,i.Z)(this,t)}return(0,o.Z)(t,[{key:"clone",value:function(){return this._cloneInto()}}]),t}();function m(t){var r=function(r){return t().update(p(r)).digest()},n=t();return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=function(){return t()},r}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(l&&"function"===typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}var E=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e,o,a){var u;return(0,i.Z)(this,n),(u=r.call(this)).blockLen=t,u.outputLen=e,u.padOffset=o,u.isLE=a,u.finished=!1,u.length=0,u.pos=0,u.destroyed=!1,u.buffer=new Uint8Array(t),u.view=v(u.buffer),u}return(0,o.Z)(n,[{key:"update",value:function(t){d.exists(this);for(var r=this.view,n=this.buffer,e=this.blockLen,i=(t=p(t)).length,o=0;o<i;){var a=Math.min(e-this.pos,i-o);if(a!==e)n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===e&&(this.process(r,0),this.pos=0);else for(var u=v(t);e<=i-o;o+=e)this.process(u,o)}return this.length+=t.length,this.roundClean(),this}},{key:"digestInto",value:function(t){d.exists(this),d.output(t,this),this.finished=!0;var r=this.buffer,n=this.view,e=this.blockLen,i=this.isLE,o=this.pos;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>e-o&&(this.process(n,0),o=0);for(var a=o;a<e;a++)r[a]=0;!function(t,r,n,e){if("function"===typeof t.setBigUint64)return t.setBigUint64(r,n,e);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),u=Number(n&o),f=e?4:0,s=e?0:4;t.setUint32(r+f,a,e),t.setUint32(r+s,u,e)}(n,e-8,BigInt(8*this.length),i),this.process(n,0);var u=v(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var s=f/4,c=this.get();if(s>c.length)throw new Error("_sha2: outputLen bigger than state");for(var h=0;h<s;h++)u.setUint32(4*h,c[h],i)}},{key:"digest",value:function(){var t=this.buffer,r=this.outputLen;this.digestInto(t);var n=t.slice(0,r);return this.destroy(),n}},{key:"_cloneInto",value:function(t){var r;t||(t=new this.constructor),(r=t).set.apply(r,(0,f.Z)(this.get()));var n=this.blockLen,e=this.buffer,i=this.length,o=this.finished,a=this.destroyed,u=this.pos;return t.length=i,t.pos=u,t.finished=o,t.destroyed=a,i%n&&t.buffer.set(e),t}}]),n}(w),B=function(t,r,n){return t&r^t&n^r&n},x=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),A=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),S=new Uint32Array(64),I=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=r.call(this,64,32,8,!1)).A=0|A[0],t.B=0|A[1],t.C=0|A[2],t.D=0|A[3],t.E=0|A[4],t.F=0|A[5],t.G=0|A[6],t.H=0|A[7],t}return(0,o.Z)(n,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(t,r,n,e,i,o,a,u){this.A=0|t,this.B=0|r,this.C=0|n,this.D=0|e,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|u}},{key:"process",value:function(t,r){for(var n=0;n<16;n++,r+=4)S[n]=t.getUint32(r,!1);for(var e=16;e<64;e++){var i=S[e-15],o=S[e-2],a=y(i,7)^y(i,18)^i>>>3,u=y(o,17)^y(o,19)^o>>>10;S[e]=u+S[e-7]+a+S[e-16]|0}for(var f,s=this.A,c=this.B,h=this.C,d=this.D,l=this.E,v=this.F,p=this.G,g=this.H,w=0;w<64;w++){var m=g+(y(l,6)^y(l,11)^y(l,25))+((f=l)&v^~f&p)+x[w]+S[w]|0,b=(y(s,2)^y(s,13)^y(s,22))+B(s,c,h)|0;g=p,p=v,v=l,l=d+m|0,d=h,h=c,c=s,s=m+b|0}s=s+this.A|0,c=c+this.B|0,h=h+this.C|0,d=d+this.D|0,l=l+this.E|0,v=v+this.F|0,p=p+this.G|0,g=g+this.H|0,this.set(s,c,h,d,l,v,p,g)}},{key:"roundClean",value:function(){S.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),n}(E),k=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=r.call(this)).A=-1056596264,t.B=914150663,t.C=812702999,t.D=-150054599,t.E=-4191439,t.F=1750603025,t.G=1694076839,t.H=-1090891868,t.outputLen=28,t}return(0,o.Z)(n)}(I),O=m((function(){return new I})),Z=(m((function(){return new k})),n(29439)),T=BigInt(0),R=BigInt(1),q=BigInt(2),U=function(t){return t instanceof Uint8Array},L=Array.from({length:256},(function(t,r){return r.toString(16).padStart(2,"0")}));function N(t){if(!U(t))throw new Error("Uint8Array expected");for(var r="",n=0;n<t.length;n++)r+=L[t[n]];return r}function H(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r}function C(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x".concat(t))}function P(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);for(var r=new Uint8Array(t.length/2),n=0;n<r.length;n++){var e=2*n,i=t.slice(e,e+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("invalid byte sequence");r[n]=o}return r}function D(t){return C(N(t))}function _(t){if(!U(t))throw new Error("Uint8Array expected");return C(N(Uint8Array.from(t).reverse()))}var V=function(t,r){return P(t.toString(16).padStart(2*r,"0"))},F=function(t,r){return V(t,r).reverse()},z=function(t){return P(H(t))};function K(t,r,n){var e;if("string"===typeof r)try{e=P(r)}catch(o){throw new Error("".concat(t,' must be valid hex string, got "').concat(r,'". Cause: ').concat(o))}else{if(!U(r))throw new Error("".concat(t," must be hex string or Uint8Array"));e=Uint8Array.from(r)}var i=e.length;if("number"===typeof n&&i!==n)throw new Error("".concat(t," expected ").concat(n," bytes, got ").concat(i));return e}function j(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new Uint8Array(r.reduce((function(t,r){return t+r.length}),0)),i=0;return r.forEach((function(t){if(!U(t))throw new Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}function M(t,r){if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!1;return!0}function Y(t){if("string"!==typeof t)throw new Error("utf8ToBytes expected string, got ".concat(typeof t));return(new TextEncoder).encode(t)}function G(t){var r;for(r=0;t>T;t>>=R,r+=1);return r}var W=function(t,r){return t>>BigInt(r)&R},X=function(t,r,n){return t|(n?R:T)<<BigInt(r)},J=function(t){return(q<<BigInt(t-1))-R},Q=function(t){return new Uint8Array(t)},$=function(t){return Uint8Array.from(t)};function tt(t,r,n){if("number"!==typeof t||t<2)throw new Error("hashLen must be a number");if("number"!==typeof r||r<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");var e=Q(t),i=Q(t),o=0,a=function(){e.fill(1),i.fill(0),o=0},u=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.apply(void 0,[i,e].concat(r))},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q();i=u($([0]),t),e=u(),0!==t.length&&(i=u($([1]),t),e=u())},s=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var t=0,n=[];t<r;){var i=(e=u()).slice();n.push(i),t+=e.length}return j.apply(void 0,n)};return function(t,r){a(),f(t);for(var n=void 0;!(n=r(s()));)f();return a(),n}}var rt={bigint:function(t){return"bigint"===typeof t},function:function(t){return"function"===typeof t},boolean:function(t){return"boolean"===typeof t},string:function(t){return"string"===typeof t},isSafeInteger:function(t){return Number.isSafeInteger(t)},array:function(t){return Array.isArray(t)},field:function(t,r){return r.Fp.isValid(t)},hash:function(t){return"function"===typeof t&&Number.isSafeInteger(t.outputLen)}};function nt(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=function(r,n,e){var i=rt[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));var o=t[r];if((!e||void 0!==o)&&!i(o,t))throw new Error("Invalid param ".concat(String(r),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))},i=0,o=Object.entries(r);i<o.length;i++){var a=(0,Z.Z)(o[i],2);e(a[0],a[1],!1)}for(var u=0,f=Object.entries(n);u<f.length;u++){var s=(0,Z.Z)(f[u],2);e(s[0],s[1],!0)}return t}var et=BigInt(0),it=BigInt(1),ot=BigInt(2),at=BigInt(3),ut=BigInt(4),ft=BigInt(5),st=BigInt(8);BigInt(9),BigInt(16);function ct(t,r){var n=t%r;return n>=et?n:r+n}function ht(t,r,n){if(n<=et||r<et)throw new Error("Expected power/modulo > 0");if(n===it)return et;for(var e=it;r>et;)r&it&&(e=e*t%n),t=t*t%n,r>>=it;return e}function dt(t,r,n){for(var e=t;r-- >et;)e*=e,e%=n;return e}function lt(t,r){if(t===et||r<=et)throw new Error("invert: expected positive integers, got n=".concat(t," mod=").concat(r));for(var n=ct(t,r),e=r,i=et,o=it,a=it,u=et;n!==et;){var f=e/n,s=e%n,c=i-a*f,h=o-u*f;e=n,n=s,i=a,o=u,a=c,u=h}if(e!==it)throw new Error("invert: does not exist");return ct(i,r)}function vt(t){if(t%ut===at){var r=(t+it)/ut;return function(t,n){var e=t.pow(n,r);if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root");return e}}if(t%st===ft){var n=(t-ft)/st;return function(t,r){var e=t.mul(r,ot),i=t.pow(e,n),o=t.mul(r,i),a=t.mul(t.mul(o,ot),i),u=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(u),r))throw new Error("Cannot find square root");return u}}return function(t){var r,n,e,i=(t-it)/ot;for(r=t-it,n=0;r%ot===et;r/=ot,n++);for(e=ot;e<t&&ht(e,i,t)!==t-it;e++);if(1===n){var o=(t+it)/ut;return function(t,r){var n=t.pow(r,o);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}var a=(r+it)/ot;return function(t,o){if(t.pow(o,i)===t.neg(t.ONE))throw new Error("Cannot find square root");for(var u=n,f=t.pow(t.mul(t.ONE,e),r),s=t.pow(o,a),c=t.pow(o,r);!t.eql(c,t.ONE);){if(t.eql(c,t.ZERO))return t.ZERO;for(var h=1,d=t.sqr(c);h<u&&!t.eql(d,t.ONE);h++)d=t.sqr(d);var l=t.pow(f,it<<BigInt(u-h-1));f=t.sqr(l),s=t.mul(s,l),c=t.mul(c,f),u=h}return s}}(t)}var yt=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pt(t){return nt(t,yt.reduce((function(t,r){return t[r]="function",t}),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function gt(t,r){var n=void 0!==r?r:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}var wt=n(98737),mt=n(1413),bt=BigInt(0),Et=BigInt(1);function Bt(t){return pt(t.Fp),nt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,mt.Z)((0,mt.Z)((0,mt.Z)({},gt(t.n,t.nBitLength)),t),{p:t.Fp.ORDER}))}var xt=D,At=P,St={Err:function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,i.Z)(this,n),r.call(this,t)}return(0,o.Z)(n)}((0,wt.Z)(Error)),_parseInt:function(t){var r=St.Err;if(t.length<2||2!==t[0])throw new r("Invalid signature integer tag");var n=t[1],e=t.subarray(2,n+2);if(!n||e.length!==n)throw new r("Invalid signature integer: wrong length");if(128&e[0])throw new r("Invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("Invalid signature integer: unnecessary leading zero");return{d:xt(e),l:t.subarray(n+2)}},toSig:function(t){var r=St.Err,n="string"===typeof t?At(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");var e=n.length;if(e<2||48!=n[0])throw new r("Invalid signature tag");if(n[1]!==e-2)throw new r("Invalid signature: incorrect length");var i=St._parseInt(n.subarray(2)),o=i.d,a=i.l,u=St._parseInt(a),f=u.d;if(u.l.length)throw new r("Invalid signature: left bytes after parsing");return{r:o,s:f}},hexFromSig:function(t){var r=function(t){return 8&Number.parseInt(t[0],16)?"00"+t:t},n=function(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r},e=r(n(t.s)),i=r(n(t.r)),o=e.length/2,a=i.length/2,u=n(o),f=n(a);return"30".concat(n(a+o+4),"02").concat(f).concat(i,"02").concat(u).concat(e)}},It=BigInt(0),kt=BigInt(1),Ot=BigInt(2),Zt=BigInt(3),Tt=BigInt(4);function Rt(t){var r=function(t){var r=Bt(t);nt(r,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=r.endo,e=r.Fp,i=r.a;if(n){if(!e.eql(i,e.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze((0,mt.Z)({},r))}(t),n=r.Fp,e=r.toBytes||function(t,r,e){var i=r.toAffine();return j(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},a=r.fromBytes||function(t){var r=t.subarray(1);return{x:n.fromBytes(r.subarray(0,n.BYTES)),y:n.fromBytes(r.subarray(n.BYTES,2*n.BYTES))}};function u(t){var e=r.a,i=r.b,o=n.sqr(t),a=n.mul(o,t);return n.add(n.add(a,n.mul(t,e)),i)}if(!n.eql(n.sqr(r.Gy),u(r.Gx)))throw new Error("bad generator point: equation left != right");function f(t){return"bigint"===typeof t&&It<t&&t<r.n}function s(t){if(!f(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){var n,e=r.allowedPrivateKeyLengths,i=r.nByteLength,o=r.wrapPrivateKey,a=r.n;if(e&&"bigint"!==typeof t){if(t instanceof Uint8Array&&(t=N(t)),"string"!==typeof t||!e.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*i,"0")}try{n="bigint"===typeof t?t:D(K("private key",t,i))}catch(u){throw new Error("private key must be ".concat(i," bytes, hex or bigint, not ").concat(typeof t))}return o&&(n=ct(n,a)),s(n),n}var h=new Map;function d(t){if(!(t instanceof l))throw new Error("ProjectivePoint expected")}var l=function(){function t(r,e,o){if((0,i.Z)(this,t),this.px=r,this.py=e,this.pz=o,null==r||!n.isValid(r))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==o||!n.isValid(o))throw new Error("z required")}return(0,o.Z)(t,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(t){this._WINDOW_SIZE=t,h.delete(this)}},{key:"assertValidity",value:function(){if(this.is0()){if(r.allowInfinityPoint)return;throw new Error("bad point: ZERO")}var t=this.toAffine(),e=t.x,i=t.y;if(!n.isValid(e)||!n.isValid(i))throw new Error("bad point: x or y not FE");var o=n.sqr(i),a=u(e);if(!n.eql(o,a))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}},{key:"hasEvenY",value:function(){var t=this.toAffine().y;if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(t){d(t);var r=this.px,e=this.py,i=this.pz,o=t.px,a=t.py,u=t.pz,f=n.eql(n.mul(r,u),n.mul(o,i)),s=n.eql(n.mul(e,u),n.mul(a,i));return f&&s}},{key:"negate",value:function(){return new t(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var e=r.a,i=r.b,o=n.mul(i,Zt),a=this.px,u=this.py,f=this.pz,s=n.ZERO,c=n.ZERO,h=n.ZERO,d=n.mul(a,a),l=n.mul(u,u),v=n.mul(f,f),y=n.mul(a,u);return y=n.add(y,y),h=n.mul(a,f),h=n.add(h,h),s=n.mul(e,h),c=n.mul(o,v),c=n.add(s,c),s=n.sub(l,c),c=n.add(l,c),c=n.mul(s,c),s=n.mul(y,s),h=n.mul(o,h),v=n.mul(e,v),y=n.sub(d,v),y=n.mul(e,y),y=n.add(y,h),h=n.add(d,d),d=n.add(h,d),d=n.add(d,v),d=n.mul(d,y),c=n.add(c,d),v=n.mul(u,f),v=n.add(v,v),d=n.mul(v,y),s=n.sub(s,d),h=n.mul(v,l),h=n.add(h,h),new t(s,c,h=n.add(h,h))}},{key:"add",value:function(e){d(e);var i=this.px,o=this.py,a=this.pz,u=e.px,f=e.py,s=e.pz,c=n.ZERO,h=n.ZERO,l=n.ZERO,v=r.a,y=n.mul(r.b,Zt),p=n.mul(i,u),g=n.mul(o,f),w=n.mul(a,s),m=n.add(i,o),b=n.add(u,f);m=n.mul(m,b),b=n.add(p,g),m=n.sub(m,b),b=n.add(i,a);var E=n.add(u,s);return b=n.mul(b,E),E=n.add(p,w),b=n.sub(b,E),E=n.add(o,a),c=n.add(f,s),E=n.mul(E,c),c=n.add(g,w),E=n.sub(E,c),l=n.mul(v,b),c=n.mul(y,w),l=n.add(c,l),c=n.sub(g,l),l=n.add(g,l),h=n.mul(c,l),g=n.add(p,p),g=n.add(g,p),w=n.mul(v,w),b=n.mul(y,b),g=n.add(g,w),w=n.sub(p,w),w=n.mul(v,w),b=n.add(b,w),p=n.mul(g,b),h=n.add(h,p),p=n.mul(E,b),c=n.mul(m,c),c=n.sub(c,p),p=n.mul(m,g),l=n.mul(E,l),new t(c,h,l=n.add(l,p))}},{key:"subtract",value:function(t){return this.add(t.negate())}},{key:"is0",value:function(){return this.equals(t.ZERO)}},{key:"wNAF",value:function(r){return y.wNAFCached(this,h,r,(function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}))}},{key:"multiplyUnsafe",value:function(e){var i=t.ZERO;if(e===It)return i;if(s(e),e===kt)return this;var o=r.endo;if(!o)return y.unsafeLadder(this,e);for(var a=o.splitScalar(e),u=a.k1neg,f=a.k1,c=a.k2neg,h=a.k2,d=i,l=i,v=this;f>It||h>It;)f&kt&&(d=d.add(v)),h&kt&&(l=l.add(v)),v=v.double(),f>>=kt,h>>=kt;return u&&(d=d.negate()),c&&(l=l.negate()),l=new t(n.mul(l.px,o.beta),l.py,l.pz),d.add(l)}},{key:"multiply",value:function(e){s(e);var i,o,a=e,u=r.endo;if(u){var f=u.splitScalar(a),c=f.k1neg,h=f.k1,d=f.k2neg,l=f.k2,v=this.wNAF(h),p=v.p,g=v.f,w=this.wNAF(l),m=w.p,b=w.f;p=y.constTimeNegate(c,p),m=y.constTimeNegate(d,m),m=new t(n.mul(m.px,u.beta),m.py,m.pz),i=p.add(m),o=g.add(b)}else{var E=this.wNAF(a);i=E.p,o=E.f}return t.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(r,n,e){var i=t.BASE,o=function(t,r){return r!==It&&r!==kt&&t.equals(i)?t.multiply(r):t.multiplyUnsafe(r)},a=o(this,n).add(o(r,e));return a.is0()?void 0:a}},{key:"toAffine",value:function(t){var r=this.px,e=this.py,i=this.pz,o=this.is0();null==t&&(t=o?n.ONE:n.inv(i));var a=n.mul(r,t),u=n.mul(e,t),f=n.mul(i,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(f,n.ONE))throw new Error("invZ was invalid");return{x:a,y:u}}},{key:"isTorsionFree",value:function(){var n=r.h,e=r.isTorsionFree;if(n===kt)return!0;if(e)return e(t,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=r.h,e=r.clearCofactor;return n===kt?this:e?e(t,this):this.multiplyUnsafe(r.h)}},{key:"toRawBytes",value:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),e(t,this,r)}},{key:"toHex",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return N(this.toRawBytes(t))}}],[{key:"fromAffine",value:function(r){var e=r||{},i=e.x,o=e.y;if(!r||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(r instanceof t)throw new Error("projective point not allowed");var a=function(t){return n.eql(t,n.ZERO)};return a(i)&&a(o)?t.ZERO:new t(i,o,n.ONE)}},{key:"normalizeZ",value:function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}},{key:"fromHex",value:function(r){var n=t.fromAffine(a(K("pointHex",r)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(r){return t.BASE.multiply(c(r))}}]),t}();l.BASE=new l(r.Gx,r.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);var v=r.nBitLength,y=function(t,r){var n=function(t,r){var n=r.negate();return t?n:r},e=function(t){return{windows:Math.ceil(r/t)+1,windowSize:Math.pow(2,t-1)}};return{constTimeNegate:n,unsafeLadder:function(r,n){for(var e=t.ZERO,i=r;n>bt;)n&Et&&(e=e.add(i)),i=i.double(),n>>=Et;return e},precomputeWindow:function(t,r){for(var n=e(r),i=n.windows,o=n.windowSize,a=[],u=t,f=u,s=0;s<i;s++){f=u,a.push(f);for(var c=1;c<o;c++)f=f.add(u),a.push(f);u=f.double()}return a},wNAF:function(r,i,o){for(var a=e(r),u=a.windows,f=a.windowSize,s=t.ZERO,c=t.BASE,h=BigInt(Math.pow(2,r)-1),d=Math.pow(2,r),l=BigInt(r),v=0;v<u;v++){var y=v*f,p=Number(o&h);o>>=l,p>f&&(p-=d,o+=Et);var g=y,w=y+Math.abs(p)-1,m=v%2!==0,b=p<0;0===p?c=c.add(n(m,i[g])):s=s.add(n(b,i[w]))}return{p:s,f:c}},wNAFCached:function(t,r,n,e){var i=t._WINDOW_SIZE||1,o=r.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&r.set(t,e(o))),this.wNAF(i,o,n)}}}(l,r.endo?Math.ceil(v/2):v);return{CURVE:r,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:f}}function qt(t){var r=function(t){var r=Bt(t);return nt(r,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,mt.Z)({lowS:!0},r))}(t),n=r.Fp,a=r.n,u=n.BYTES+1,f=2*n.BYTES+1;function s(t){return ct(t,a)}function c(t){return lt(t,a)}var h=Rt((0,mt.Z)((0,mt.Z)({},r),{},{toBytes:function(t,r,e){var i=r.toAffine(),o=n.toBytes(i.x),a=j;return e?a(Uint8Array.from([r.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(t){var r=t.length,e=t[0],i=t.subarray(1);if(r!==u||2!==e&&3!==e){if(r===f&&4===e)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw new Error("Point of length ".concat(r," was invalid. Expected ").concat(u," compressed bytes or ").concat(f," uncompressed bytes"))}var o=D(i);if(!(It<(a=o)&&a<n.ORDER))throw new Error("Point is not on curve");var a,s=v(o),c=n.sqrt(s);return 1===(1&e)!==((c&kt)===kt)&&(c=n.neg(c)),{x:o,y:c}}})),d=h.ProjectivePoint,l=h.normPrivateKeyToScalar,v=h.weierstrassEquation,y=h.isWithinCurveOrder,p=function(t){return N(V(t,r.nByteLength))};function g(t){return t>a>>kt}var w=function(t,r,n){return D(t.slice(r,n))},m=function(){function t(r,n,e){(0,i.Z)(this,t),this.r=r,this.s=n,this.recovery=e,this.assertValidity()}return(0,o.Z)(t,[{key:"assertValidity",value:function(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}},{key:"addRecoveryBit",value:function(r){return new t(this.r,this.s,r)}},{key:"recoverPublicKey",value:function(t){var e=this.r,i=this.s,o=this.recovery,a=x(K("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?e+r.n:e;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=0===(1&o)?"02":"03",h=d.fromHex(f+p(u)),l=c(u),v=s(-a*l),y=s(i*l),g=d.BASE.multiplyAndAddUnsafe(h,v,y);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}},{key:"hasHighS",value:function(){return g(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new t(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return P(this.toDERHex())}},{key:"toDERHex",value:function(){return St.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return P(this.toCompactHex())}},{key:"toCompactHex",value:function(){return p(this.r)+p(this.s)}}],[{key:"fromCompact",value:function(n){var e=r.nByteLength;return n=K("compactSignature",n,2*e),new t(w(n,0,e),w(n,e,2*e))}},{key:"fromDER",value:function(r){var n=St.toSig(K("DER",r));return new t(n.r,n.s)}}]),t}(),b={isValidPrivateKey:function(t){try{return l(t),!0}catch(r){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:function(){var t=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=(t=K("privateHash",t)).length,i=gt(r).nByteLength+8;if(i<24||e<i||e>1024)throw new Error("hashToPrivateScalar: expected ".concat(i,"-1024 bytes of input, got ").concat(e));return ct(n?_(t):D(t),r-it)+it}(r.randomBytes(n.BYTES+8),a);return V(t,r.nByteLength)},precompute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.BASE;return r._setWindowSize(t),r.multiply(BigInt(3)),r}};function E(t){var r=t instanceof Uint8Array,n="string"===typeof t,e=(r||n)&&t.length;return r?e===u||e===f:n?e===2*u||e===2*f:t instanceof d}var B=r.bits2int||function(t){var n=D(t),e=8*t.length-r.nBitLength;return e>0?n>>BigInt(e):n},x=r.bits2int_modN||function(t){return s(B(t))},A=J(r.nBitLength);function S(t){if("bigint"!==typeof t)throw new Error("bigint expected");if(!(It<=t&&t<A))throw new Error("bigint expected < 2^".concat(r.nBitLength));return V(t,r.nByteLength)}function I(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k;if(["recovered","canonical"].some((function(t){return t in o})))throw new Error("sign() legacy options not supported");var a=r.hash,u=r.randomBytes,f=o.lowS,h=o.prehash,v=o.extraEntropy;null==f&&(f=!0),t=K("msgHash",t),h&&(t=K("prehashed msgHash",a(t)));var p=x(t),w=l(i),b=[S(w),S(p)];if(null!=v){var E=!0===v?u(n.BYTES):v;b.push(K("extraEntropy",E,n.BYTES))}var A=j.apply(e,b),I=p;return{seed:A,k2sig:function(t){var r=B(t);if(y(r)){var n=c(r),e=d.BASE.multiply(r).toAffine(),i=s(e.x);if(i!==It){var o=s(n*s(I+i*w));if(o!==It){var a=(e.x===i?0:2)|Number(e.y&kt),u=o;return f&&g(o)&&(u=function(t){return g(t)?s(-t):t}(o),a^=1),new m(i,u,a)}}}}}}var k={lowS:r.lowS,prehash:!1},O={lowS:r.lowS,prehash:!1};return d.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return d.fromPrivateKey(t).toRawBytes(r)},getSharedSecret:function(t,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(E(t))throw new Error("first arg must be private key");if(!E(r))throw new Error("second arg must be public key");return d.fromHex(r).multiply(l(t)).toRawBytes(n)},sign:function(t,n){var e=I(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:k),i=e.seed,o=e.k2sig;return tt(r.hash.outputLen,r.nByteLength,r.hmac)(i,o)},verify:function(t,n,e){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O,a=t;if(n=K("msgHash",n),e=K("publicKey",e),"strict"in o)throw new Error("options.strict was renamed to lowS");var u,f=o.lowS,h=o.prehash,l=void 0;try{if("string"===typeof a||a instanceof Uint8Array)try{l=m.fromDER(a)}catch(I){if(!(I instanceof St.Err))throw I;l=m.fromCompact(a)}else{if("object"!==typeof a||"bigint"!==typeof a.r||"bigint"!==typeof a.s)throw new Error("PARSE");var v=a.r,y=a.s;l=new m(v,y)}u=d.fromHex(e)}catch(k){if("PARSE"===k.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(f&&l.hasHighS())return!1;h&&(n=r.hash(n));var p=l,g=p.r,w=p.s,b=x(n),E=c(w),B=s(b*E),A=s(g*E),S=null===(i=d.BASE.multiplyAndAddUnsafe(u,B,A))||void 0===i?void 0:i.toAffine();return!!S&&s(S.x)===g},ProjectivePoint:d,Signature:m,utils:b}}var Ut=D;function Lt(t,r){if(t<0||t>=1<<8*r)throw new Error("bad I2OSP call: value=".concat(t," length=").concat(r));for(var n=Array.from({length:r}).fill(0),e=r-1;e>=0;e--)n[e]=255&t,t>>>=8;return new Uint8Array(n)}function Nt(t,r){for(var n=new Uint8Array(t.length),e=0;e<t.length;e++)n[e]=t[e]^r[e];return n}function Ht(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function Ct(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Pt(t,r,n){nt(n,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});var e=n.p,i=n.k,o=n.m,a=n.hash,u=n.expand,f=n.DST;Ht(t),Ct(r);var s,c=function(t){if(t instanceof Uint8Array)return t;if("string"===typeof t)return Y(t);throw new Error("DST must be Uint8Array or string")}(f),h=e.toString(2).length,d=Math.ceil((h+i)/8),l=r*o*d;if("xmd"===u)s=function(t,r,n,e){Ht(t),Ht(r),Ct(n),r.length>255&&(r=e(j(Y("H2C-OVERSIZE-DST-"),r)));var i=e.outputLen,o=e.blockLen,a=Math.ceil(n/i);if(a>255)throw new Error("Invalid xmd length");var u=j(r,Lt(r.length,1)),f=Lt(0,o),s=Lt(n,2),c=new Array(a),h=e(j(f,t,s,Lt(0,1),u));c[0]=e(j(h,Lt(1,1),u));for(var d=1;d<=a;d++){var l=[Nt(h,c[d-1]),Lt(d+1,1),u];c[d]=e(j.apply(void 0,l))}return j.apply(void 0,c).slice(0,n)}(t,c,l,a);else if("xof"===u)s=function(t,r,n,e,i){if(Ht(t),Ht(r),Ct(n),r.length>255){var o=Math.ceil(2*e/8);r=i.create({dkLen:o}).update(Y("H2C-OVERSIZE-DST-")).update(r).digest()}if(n>65535||r.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(Lt(n,2)).update(r).update(Lt(r.length,1)).digest()}(t,c,l,i,a);else{if("_internal_pass"!==u)throw new Error('expand must be "xmd" or "xof"');s=t}for(var v=new Array(r),y=0;y<r;y++){for(var p=new Array(o),g=0;g<o;g++){var w=d*(g+y*o),m=s.subarray(w,w+d);p[g]=ct(Ut(m),e)}v[y]=p}return v}var Dt=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e){var o;(0,i.Z)(this,n),(o=r.call(this)).finished=!1,o.destroyed=!1,d.hash(t);var a=p(e);if(o.iHash=t.create(),"function"!==typeof o.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");o.blockLen=o.iHash.blockLen,o.outputLen=o.iHash.outputLen;var u=o.blockLen,f=new Uint8Array(u);f.set(a.length>u?t.create().update(a).digest():a);for(var s=0;s<f.length;s++)f[s]^=54;o.iHash.update(f),o.oHash=t.create();for(var c=0;c<f.length;c++)f[c]^=106;return o.oHash.update(f),f.fill(0),o}return(0,o.Z)(n,[{key:"update",value:function(t){return d.exists(this),this.iHash.update(t),this}},{key:"digestInto",value:function(t){d.exists(this),d.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}},{key:"digest",value:function(){var t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}},{key:"_cloneInto",value:function(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));var r=this.oHash,n=this.iHash,e=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return t.finished=e,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),n}(w),_t=function(t,r,n){return new Dt(t,r).update(n).digest()};function Vt(t){return{hash:t,hmac:function(r){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];return _t(t,r,g.apply(void 0,e))},randomBytes:b}}_t.create=function(t,r){return new Dt(t,r)};var Ft=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),zt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Kt=BigInt(1),jt=BigInt(2),Mt=function(t,r){return(t+r/jt)/r};function Yt(t){var r=Ft,n=BigInt(3),e=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),u=BigInt(44),f=BigInt(88),s=t*t*t%r,c=s*s*t%r,h=dt(c,n,r)*c%r,d=dt(h,n,r)*c%r,l=dt(d,jt,r)*s%r,v=dt(l,i,r)*l%r,y=dt(v,o,r)*v%r,p=dt(y,u,r)*y%r,g=dt(p,f,r)*p%r,w=dt(g,u,r)*y%r,m=dt(w,n,r)*c%r,b=dt(m,a,r)*v%r,E=dt(b,e,r)*s%r,B=dt(E,jt,r);if(!Gt.eql(Gt.sqr(B),t))throw new Error("Cannot find square root");return B}var Gt=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=et)throw new Error("Expected Fp ORDER > 0, got ".concat(t));var i=gt(t,r),o=i.nBitLength,a=i.nByteLength;if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");var u=vt(t),f=Object.freeze({ORDER:t,BITS:o,BYTES:a,MASK:J(o),ZERO:et,ONE:it,create:function(r){return ct(r,t)},isValid:function(r){if("bigint"!==typeof r)throw new Error("Invalid field element: expected bigint, got ".concat(typeof r));return et<=r&&r<t},is0:function(t){return t===et},isOdd:function(t){return(t&it)===it},neg:function(r){return ct(-r,t)},eql:function(t,r){return t===r},sqr:function(r){return ct(r*r,t)},add:function(r,n){return ct(r+n,t)},sub:function(r,n){return ct(r-n,t)},mul:function(r,n){return ct(r*n,t)},pow:function(t,r){return function(t,r,n){if(n<et)throw new Error("Expected power > 0");if(n===et)return t.ONE;if(n===it)return r;for(var e=t.ONE,i=r;n>et;)n&it&&(e=t.mul(e,i)),i=t.sqr(i),n>>=it;return e}(f,t,r)},div:function(r,n){return ct(r*lt(n,t),t)},sqrN:function(t){return t*t},addN:function(t,r){return t+r},subN:function(t,r){return t-r},mulN:function(t,r){return t*r},inv:function(r){return lt(r,t)},sqrt:e.sqrt||function(t){return u(f,t)},invertBatch:function(t){return function(t,r){var n=new Array(r.length),e=r.reduce((function(r,e,i){return t.is0(e)?r:(n[i]=r,t.mul(r,e))}),t.ONE),i=t.inv(e);return r.reduceRight((function(r,e,i){return t.is0(e)?r:(n[i]=t.mul(r,n[i]),t.mul(r,e))}),i),n}(f,t)},cmov:function(t,r,n){return n?r:t},toBytes:function(t){return n?F(t,a):V(t,a)},fromBytes:function(t){if(t.length!==a)throw new Error("Fp.fromBytes: expected ".concat(a,", got ").concat(t.length));return n?_(t):D(t)}});return Object.freeze(f)}(Ft,void 0,void 0,{sqrt:Yt}),Wt=function(t,r){var n=function(r){return qt((0,mt.Z)((0,mt.Z)({},t),Vt(r)))};return Object.freeze((0,mt.Z)((0,mt.Z)({},n(r)),{},{create:n}))}({a:BigInt(0),b:BigInt(7),Fp:Gt,n:zt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(t){var r=zt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),e=-Kt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,a=BigInt("0x100000000000000000000000000000000"),u=Mt(o*t,r),f=Mt(-e*t,r),s=ct(t-u*n-f*i,r),c=ct(-u*e-f*o,r),h=s>a,d=c>a;if(h&&(s=r-s),d&&(c=r-c),s>a||c>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:s,k2neg:d,k2:c}}}},O),Xt=BigInt(0),Jt=function(t){return"bigint"===typeof t&&Xt<t&&t<Ft},Qt=function(t){return"bigint"===typeof t&&Xt<t&&t<zt},$t={};function tr(t){var r=$t[t];if(void 0===r){var n=O(Uint8Array.from(t,(function(t){return t.charCodeAt(0)})));r=j(n,n),$t[t]=r}for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];return O(j.apply(void 0,[r].concat(i)))}var rr=function(t){return t.toRawBytes(!0).slice(1)},nr=function(t){return V(t,32)},er=function(t){return ct(t,Ft)},ir=function(t){return ct(t,zt)},or=Wt.ProjectivePoint,ar=function(t,r,n){return or.BASE.multiplyAndAddUnsafe(t,r,n)};function ur(t){var r=Wt.utils.normPrivateKeyToScalar(t),n=or.fromPrivateKey(r);return{scalar:n.hasEvenY()?r:ir(-r),bytes:rr(n)}}function fr(t){if(!Jt(t))throw new Error("bad x: need 0 < x < p");var r=er(t*t),n=Yt(er(r*t+BigInt(7)));n%jt!==Xt&&(n=er(-n));var e=new or(t,n,Kt);return e.assertValidity(),e}function sr(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ir(D(tr.apply(void 0,["BIP0340/challenge"].concat(r))))}function cr(t,r,n){var e=K("signature",t,64),i=K("message",r),o=K("publicKey",n,32);try{var a=fr(D(o)),u=D(e.subarray(0,32));if(!Jt(u))return!1;var f=D(e.subarray(32,64));if(!Qt(f))return!1;var s=sr(nr(u),rr(a),i),c=ar(a,f,ir(-s));return!(!c||!c.hasEvenY()||c.toAffine().x!==u)}catch(h){return!1}}var hr={getPublicKey:function(t){return ur(t).bytes},sign:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b(32),e=K("message",t),i=ur(r),o=i.bytes,a=i.scalar,u=K("auxRand",n,32),f=nr(a^D(tr("BIP0340/aux",u))),s=tr("BIP0340/nonce",f,o,e),c=ir(D(s));if(c===Xt)throw new Error("sign failed: k is zero");var h=ur(c),d=h.bytes,l=h.scalar,v=sr(d,o,e),y=new Uint8Array(64);if(y.set(d,0),y.set(nr(ir(l+v*a)),32),!cr(y,e,o))throw new Error("sign: Invalid signature produced");return y},verify:cr,utils:{randomPrivateKey:Wt.utils.randomPrivateKey,lift_x:fr,pointToBytes:rr,numberToBytesBE:V,bytesToNumberBE:D,taggedHash:tr,mod:ct}},dr=function(t,r){var n=r.map((function(t){return Array.from(t).reverse()}));return function(r,e){var i=n.map((function(n){return n.reduce((function(n,e){return t.add(t.mul(n,r),e)}))})),o=(0,Z.Z)(i,4),a=o[0],u=o[1],f=o[2],s=o[3];return r=t.div(a,u),e=t.mul(e,t.div(f,s)),{x:r,y:e}}}(Gt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((function(t){return t.map((function(t){return BigInt(t)}))}))),lr=function(t,r){if(pt(t),!t.isValid(r.A)||!t.isValid(r.B)||!t.isValid(r.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");var n=function(t,r){for(var n=t.ORDER,e=It,i=n-kt;i%Ot===It;i/=Ot)e+=kt;var o=e,a=(n-kt)/Math.pow(Ot,o),u=(a-kt)/Ot,f=Math.pow(Ot,o)-kt,s=Math.pow(Ot,o-kt),c=t.pow(r,a),h=t.pow(r,(a+kt)/Ot),d=function(r,n){var e=c,i=t.pow(n,f),a=t.sqr(i);a=t.mul(a,n);var d=t.mul(r,a);d=t.pow(d,u),d=t.mul(d,i),i=t.mul(d,n),a=t.mul(d,r);var l=t.mul(a,i);d=t.pow(l,s);var v=t.eql(d,t.ONE);i=t.mul(a,h),d=t.mul(l,e),a=t.cmov(i,a,v),l=t.cmov(d,l,v);for(var y=o;y>kt;y--){var p=Math.pow(Ot,y-Ot),g=t.pow(l,p),w=t.eql(g,t.ONE);i=t.mul(a,e),e=t.mul(e,e),g=t.mul(l,e),a=t.cmov(i,a,w),l=t.cmov(g,l,w)}return{isValid:v,value:a}};if(t.ORDER%Tt===Zt){var l=(t.ORDER-Zt)/Tt,v=t.sqrt(t.neg(r));d=function(r,n){var e=t.sqr(n),i=t.mul(r,n);e=t.mul(e,i);var o=t.pow(e,l);o=t.mul(o,i);var a=t.mul(o,v),u=t.mul(t.sqr(o),n),f=t.eql(u,r);return{isValid:f,value:t.cmov(a,o,f)}}}return d}(t,r.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return function(e){var i,o,a,u,f,s,c,h;i=t.sqr(e),i=t.mul(i,r.Z),o=t.sqr(i),o=t.add(o,i),a=t.add(o,t.ONE),a=t.mul(a,r.B),u=t.cmov(r.Z,t.neg(o),!t.eql(o,t.ZERO)),u=t.mul(u,r.A),o=t.sqr(a),s=t.sqr(u),f=t.mul(s,r.A),o=t.add(o,f),o=t.mul(o,a),s=t.mul(s,u),f=t.mul(s,r.B),o=t.add(o,f),c=t.mul(i,a);var d=n(o,s),l=d.isValid,v=d.value;h=t.mul(i,e),h=t.mul(h,v),c=t.cmov(c,a,l),h=t.cmov(h,v,l);var y=t.isOdd(e)===t.isOdd(h);return h=t.cmov(t.neg(h),h,y),{x:c=t.div(c,u),y:h}}}(Gt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Gt.create(BigInt("-11"))}),vr=function(t,r,n){if("function"!==typeof r)throw new Error("mapToCurve() must be defined");return{hashToCurve:function(e,i){var o=Pt(e,2,(0,mt.Z)((0,mt.Z)({},n),{},{DST:n.DST},i)),a=t.fromAffine(r(o[0])),u=t.fromAffine(r(o[1])),f=a.add(u).clearCofactor();return f.assertValidity(),f},encodeToCurve:function(e,i){var o=Pt(e,1,(0,mt.Z)((0,mt.Z)({},n),{},{DST:n.encodeDST},i)),a=t.fromAffine(r(o[0])).clearCofactor();return a.assertValidity(),a}}}(Wt.ProjectivePoint,(function(t){var r=lr(Gt.create(t[0])),n=r.x,e=r.y;return dr(n,e)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Gt.ORDER,m:1,k:128,expand:"xmd",hash:O}),yr=vr.hashToCurve,pr=vr.encodeToCurve}}]);
//# sourceMappingURL=890.8e348393.chunk.js.map